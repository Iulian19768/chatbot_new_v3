<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toggleable Banner</title>
    {% load static %}
    <!-- Load the CSS file -->
    <link rel="stylesheet" href="{% static 'chatbot.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca&display=swap" rel="stylesheet">

    <style>

        html, body {
            
            font-family: 'Lexend Deca', sans-serif;
            
        }

        .contentmap {
            height: 100%;
            width: 100%;
            display: none; /* Hide by default */
        }

        .hidden {
            display: none;
        }
        .containterofcontent {
            width: calc(100% - 16px);
            height: 100%;
            margin-right: 8px;
            margin-top: 8px;
            margin-bottom: 8px;
            margin-left: 8px;
            
            display: flex;
            flex-direction: column;
        }


        .progressbar {
            background-color: #f3f3f3;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            height: 20px;
            margin: 8px 20px;
        }

        .progress {
            width: 30%;
            background-color: #0088cc;
            height: 100%;
            border-radius: 10px;
            position: absolute;
            top: 0;
            left: 0;
            transition: width 0.3s ease;
        }

        .step {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 25px;
            height: 25px;
            line-height: 25px;
            border-radius: 50%;
            color: white;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
        }

        /* Step positioning */
        .step-1 { left: 23%; }
        .step-2 { left: 48%; }
        .step-3 { left: 73%; }
        .step-4 { left: 95%; }

        /* Responsive step positioning */
        @media (max-width: 600px) {
            .progressbar {
                height: 30px;
            }

            .step {
                width: 20px;
                height: 20px;
                line-height: 20px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 400px) {
            .progressbar {
                height: 25px;
            }

            .step {
                width: 18px;
                height: 18px;
                line-height: 18px;
                font-size: 0.7rem;
            }
        }

        .welcomemessage {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .welcomemessage p {
            margin-bottom: -10px;
        }

        .smallertext {
            text-align: center;
            font-size: 1rem;
        }

        .typeofwhydidyoucomein {
            text-align: center;
            display: flex;
            flex-direction: column;
            margin: 0 20px;
            
            overflow-y: auto;
        }
        .typeofwhydidyoucomein button:hover{
            color:black;
            border:1px solid black;
            cursor: pointer;
        }

        

        .typeofwhydidyoucomein button {
            color: #bcbcbc;
            border: none;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 4px;
            max-width: 100%;
            background: #f9f9f9;
            font-size: 1rem;
            border: 1px solid #bcbcbc;
            
        }

        .previewsandforwardbutton {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
        }

        .previewsandforwardbutton button {
            color: #555;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: 600;
            background: #f9f9f9;
            font-size: 1rem;
            
        }
        .previewsandforwardbutton button:hover{
            cursor: pointer;
        }
        /* Media Queries for smaller screens */
        @media (max-width: 400px) {
            .containterofthecontainer {
                width: 95%;
                padding: 10px;
            }

            .welcomemessage {
                font-size: 1.2rem;
            }

            .smallertext {
                font-size: 0.9rem;
            }

            .typeofwhydidyoucomein button {
                font-size: 0.9rem;
                
            }

            .previewsandforwardbutton button {
                font-size: 0.9rem;
                padding: 6px 12px;
                
            }
        }
        .horizontalblocs{
            display: flex;
            flex-direction: row;
            text-align: center;
            align-items: center;
            margin: 16px;
            margin-right: 8px;
            
        }
        .horizontalblocs input{
            color: black;
            border: none;
            padding: 8px ;
            border-radius: 5px;
            font-weight: 200;
            background: #f9f9f9;
            font-size: 1rem;
            width: 100px;
            margin-right: 16px;
            text-align: center;
            margin-bottom: -10px;
           
            
        }
        .horizontalblocs button{
            color: #555;
            border: none;
            padding: 8px ;
            border-radius: 5px;
            font-weight: 200;
            background: #f9f9f9;
            font-size: 1rem;
            width: 110px;
            
            text-align: center;
            
        }

        .horizontalblocs button:hover{
            cursor: pointer;
            
        }
        .selected {
            background-color: burlywood; /* Example highlight color */
            color: red; /* Change text color if needed */
        }

        /* Define the initial hidden state for the boxes */
        
        /* Define a fade-in animation */
        .fade-in {
            animation: fadeIn 0.5s forwards;
        }

        /* Define a fade-out animation */
        .fade-out {
            animation: fadeOut 0.5s forwards;
        }

        /* Keyframes for fading in */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Keyframes for fading out */
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .patientBtn.active {
            background-color: #0088cc; /* Example color for active state */
            color: rgb(255, 255, 255); /* Example text color for active state */
        }

        .progressstep2{
            width: 60%;
            background-color: #0088cc;
            height: 100%;
            border-radius: 10px;
            position: absolute;
            top: 0;
            left: 0;
            transition: width 0.3s ease;
        }

        
        .typeofbtn.clicked {
            background-color: #0088cc; /* Background color when clicked */
            color: #fff; /* Text color when clicked */
            
        }

        

        .weekcalendar {
            display: flex;
            flex-direction: row;
            border: 2px solid #f3f3f3;
            gap: 35%;
            margin: 8px;
            margin-left: 8px;
            background-color: #f3f3f3;
            border-radius: 5px;
            height: 25px;
            padding-top: 4px;
        }

        .weekcalendar p {
            margin-left: 8px;
            margin-top: 0px;
            color: #555;
        }

        .weekcalendar button {
            border-radius: 5px;
            border: none;
            margin-top: 0px;
            border: 1px solid white;
            height: 20px;
            color: #555;
        }

        .weekcalendar button:hover {
            border: 1px solid black;
            color: black;
            cursor: pointer;
        }
        
        .weekcalendar p:hover{
            cursor:pointer;
        }
        .progressstep3{
            width: 80%;
            background-color: #0088cc;
            height: 100%;
            border-radius: 10px;
            position: absolute;
            top: 0;
            left: 0;
            transition: width 0.3s ease;
        }

        .scrollablecontainer{
            max-height: 440px;
            height: 390px;
            
            overflow-y: auto;
            overflow-x: hidden;
        }

        
        .scrollablecontainer::-webkit-scrollbar {
            width: 5px;
            background-color: transparent;
            overflow-x: hidden;
        }

        .scrollablecontainer::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .scrollablecontainer::-webkit-scrollbar-thumb {
            background: #bcbcbc;
            border-radius: 3px;
            color: white;
        }

        .horizontaldate{
            margin: 16px;
            margin-top: 32px;
            margin-bottom: 32px;
        }

        .horizontaldate input{
            
            padding: 8px;
            border: 2px solid #f3f3f3;
            background-color: #f3f3f3;
            border-radius: 5px;
            color: #555;
        }
        .progressstep4{
            width: 100%;
            background-color: #0088cc;
            height: 100%;
            border-radius: 10px;
            position: absolute;
            top: 0;
            left: 0;
            transition: width 0.3s ease;
        }

        .topnvbar{

            display: flex;
            flex-direction: row;
            gap:87%;
            margin:4px;
            margin-top: -20px;
        }
        .topnvbar button{
            border: none;
            background-color: transparent;
            font-weight: 600;
        }
        .invisible{
            color: transparent;
        }

        .step5middlecontainer{
            border: 2px solid #f3f3f3;
            background-color: #f3f3f3;
            border-radius:5px;
            width:auto;
            height: 235px;
            margin: 16px;
            font-size: 14px;
            padding: 8px;
        }
        .step5middlecontainer p{
            margin-bottom: 4px;
        }
        .chat_immages{
            display: flex;
            flex-direction: column;
            background-color: #0088cc;
            margin: 8px;
            width: 100%;
            align-items: center;
            border-radius: 8px;
            margin-bottom: -8px;
        }

        
        .addressbutton{
            background-color:#0088cc;
            color:black;
            border-radius:5px;
        }
        .menu-text.show {
            display: block; /* Show the text when the menu is toggled */
            background-color: #0088cc;
            height: 50px;
            margin-right: -21px;
            padding-right: 50px;
            padding-top: 25px;
            border-top-left-radius: 100px;
            border-bottom-left-radius: 100px;
        }

        #box.showbox {
            height: 470px; /* Set the height when showing the box */
            display: flex;
            align-items: center;
            justify-content: center;
        }



        /* new code for the button */

        .buttontest {
            position: absolute;
            bottom: 20px; /* Adjust the distance from the bottom edge */
            right: 20px;  /* Adjust the distance from the right edge */
            display: flex;
            align-items: center; /* Center items vertically */
        }

        .buttontest button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 40px 40px 0px 40px; /* Make the button fully rounded */
            position: relative; /* Ensure the button is positioned relative to its container */
            transition: border-radius 0.5s ease, background-color 0.5s ease; /* Add smooth transitions */
            background-color: #0088cc;
            overflow: hidden; /* Ensure the image fits within the button */
        }

        .buttontest button::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0088cc; /* Apply the desired color to the rectangle */
            border-radius: 40px; /* Match the button's border radius */
            transition: background-color 0.5s ease; /* Smooth transition for background color */
        }

        .buttontest button::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 50px;
            height: 50px;
            background-color: #0088cc; /* Same color as the rectangle */
            border-radius: 40px; /* Same radius to match button */
            transition: background-color 0.5s ease; /* Smooth transition for background color */
        }

        .buttontest button img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(0deg); /* Center and rotate the image */
            transition: transform 0.5s ease; /* Smooth transition for image rotation */
            width: 55px; /* Adjust the size of the image as needed */
            height: 55px; /* Adjust the size of the image as needed */
            z-index: 10;
        }

        .buttontest button:hover::before {
            background-color: #0088cc; /* Change rectangle color on hover */
        }

        .buttontest button:hover::after {
            background-color: #0088cc; /* Change color for the corner area on hover */
        }

        .buttontest button:hover img {
            transform: translate(-50%, -50%) rotate(0deg); /* Rotate the image on hover */
        }

        /* Banner styling */
        .bannerclass {
            display: none; /* Hide the banner initially */
            background-color: #0088cc;
            border: 1px solid #0088cc;
            
            border-radius: 30px 0px 0px 30px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            margin-right: -25px; /* Space between the banner and button */
            height: 49px;
            white-space: nowrap; /* Prevents the text from wrapping */
            overflow: hidden; /* Ensures that the text is hidden until animation */
        }

        /* Typing animation */
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            from { border-right: 2px solid transparent; }
            to { border-right: 2px solid black; }
        }

        .bannerclass p {
            overflow: hidden; /* Ensures that the text is hidden until animation */
            white-space: nowrap; /* Prevents the text from wrapping */
            border-right: 2px solid black; /* Cursor effect */
            animation: typing 2s steps(40, end) , blink 0.75s step-end infinite; /* Apply animation */
            font-size: 18px; /* Match the font size */
            margin-right: 25px;
            padding-left: 8px;
            margin-top:14px;
        }



        #pull-to-refresh-indicator {
            display: none;
            text-align: center;
            padding: 10px;
            background-color: #0088cc;
            color: white;
            font-size: 1rem;
        }

        /* Show indicator when pulling down */
        #pulling-down {
            display: block;
        }

        #refresh-indicator {
            position: fixed;
            top: 0px;
            left: 0;
            right: 0;
            height: 8px;
            background-color:transparent;
            color: transparent;
            text-align: center;
            line-height: 50px;
            transition: top 0.2s ease-out;
            z-index: 0;
        }

    </style>
</head>
<body>
    <!--
    <div id="menu">
        <div class="menu-text" id="spanclick">
            how may I help you 
        </div>
        
        <img src="{% static 'ico_chatbot_close.png' %}" id="menu-icon" alt="Close Icon"
             data-banner-open="{% static 'banner_open.png' %}"
             data-ico-close="{% static 'ico_chatbot_close.png' %}"
             data-box-opened="{% static 'box_opened.png' %}" />
    </div> -->
    <div id="refresh-indicator"></div>
    <div class="buttontest">
        <div class="bannerclass" id="banner">
            <p>Hello, how can I assist you?</p>
        </div>
        <button id="testButton" class="testButton">
            <img src=" {% static 'leftsmile.png' %}" id="menu-icon" alt="Icon"> <!-- Replace with your image URL -->
        </button>
    </div>
    <div id="box" class="hidden">
        <!-- Content of the box can go here -->
        <div class="contentchatbot">
            <div class="topnvbar" style="margin-top: 0px;">
            
                <button style="margin-left: 95%;">x</button>
            </div>
            <div class="welcomemessage">
                <p>Welcome!</p>
                <p>Your Dental Practice!</p>
            </div>
            <div class="widjets">
                <div class="chat" style="margin-top: -20px;">
                    <div class="chat_inner_left">
                        <div class="chat_immages">
                            <img src="{% static 'microphone.png' %}" id="chatimg" alt="Chat Icon">
                            <p>Speak</p>
                        </div>
                       
                        <div class="chat_immages">
                            <img src="{% static 'text.png' %}" alt="Chat Icon"> 
                            <p>Text</p>
                        </div>
                        
                    </div>
                    <div class="chat_inner_right" id="chat_right_inner_id">
                        <p>Chat with our AI assistant</p>
                    </div>
                </div>

                <div class="appointment" style="margin-bottom: -20px;">
                    <div class="chat_inner_left">
                        <div class="chat_immages" style="width: auto;" id="appointment_immage_button">
                            <img src="{% static 'newrequeststransparent.webp' %}" id="chatimg" alt="Chat Icon" style="padding-left: -32px;">
                        </div>
                    </div>
                    <div class="chat_inner_right" >
                        <p>Request an appointment</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="contentmap" id="mapid">
            
        </div>
        <div class="stepbox" id="step1" style="display: none;">
            <div class="containterofcontent" >
                <div class="topnvbar" style="margin-top: -20px;">
            
                    <button style="margin-left: 95%;margin-top: 30px;">x</button>
                </div>
                
                    <div class="welcomemessage" style="margin-top: -10px;">
                        <p>Thank You for choosing</p>
                        <p>Your Dental Practice!</p>
                    </div>
                    <div class="container">
                        <div class="progressbar">
                            <div class="progress"></div>
                            <div class="step step-1">1</div>
                            <div class="step step-2">2</div>
                            <div class="step step-3">3</div>
                            <div class="step step-4">4</div>
                        </div>
                    </div>
                    <div class="smallertext">
                        <p>Who is this appointment for?</p>
                    </div>
                    <div class="horizontalblocs">
                        <input type="text" id="namestep1" name="namestep1" placeholder="First Name">
                        <input type="text" id="lastnamestep1" name="lastnamestep1" placeholder="Last Name">
                    </div>
                    <div class="smallertext">
                        <p>Have you visited us before?</p>
                    </div>
                    <div class="horizontalblocs">
                        <button id="newPatientBtn" class="patientBtn" style="margin-right: 32px;height: 50px;">New Patient</button>
                        <button id="returningPatientBtn" class="patientBtn">Returning Patient</button>
                    </div>
                    <div class="previewsandforwardbutton">
                        <button id="prewbtn"><   Back</button>
                        <button id="nextbtn">Forward   ></button>
                    </div>
                
            </div>
        </div>
        <div class="stepbox" id="step2" style="display: none;">
            <div class="containterofcontent">
                <div class="topnvbar" style="margin-top: -20px;">
            
                    <button style="margin-left: 95%;">x</button>
                </div>
                <div class="scrollablecontainer">
                    <div class="welcomemessage">
                        <p>Thank You for choosing</p>
                        <p>Your Dental Practice!</p>
                    </div>
                    <div class="container">
                        <div class="progressbar">
                            <div class="progressstep2"></div>
                            <div class="step step-1">1</div>
                            <div class="step step-2">2</div>
                            <div class="step step-3">3</div>
                            <div class="step step-4">4</div>
                        </div>
                    </div>
                    <div class="smallertext">
                        <p>What would you like to come in for?</p>
                    </div>
                    <div class="typeofwhydidyoucomein">
                        <button class="typeofbtn">Emergency Exam</button>
                        <button class="typeofbtn">General Consultation</button>
                        <button class="typeofbtn">Routine Check-up and Cleaning</button>
                        <button class="typeofbtn">Braces or Orthodontic Consultation</button>
                        <button class="typeofbtn">Cosmetic Consultation</button>
                        <button class="typeofbtn">Treatment</button>
                        <button class="typeofbtn">Other</button>
                    </div>
                    <div class="previewsandforwardbutton">
                        <button id="backstep2"><   Back</button>
                        <button id="nextstep2">Forward   ></button>
                    </div>
                </div>
            </div> 
        </div>
        <div id="step3" style="display: none;">
            <div class="containterofcontent">
                <div class="topnvbar" style="margin-top: -20px;">
            
                    <button style="margin-left: 95%;">x</button>
                </div>
                <div class="scrollablecontainer">
                    <div class="welcomemessage">
                        <p>We are excited to meet </p>
                        <p>you.</p>
                    </div>
                    <div class="container">
                        <div class="progressbar">
                            <div class="progressstep3"></div>
                            <div class="step step-1">1</div>
                            <div class="step step-2">2</div>
                            <div class="step step-3">3</div>
                            <div class="step step-4">4</div>
                        </div>
                    </div>
                    <div class="smallertext">
                        <p>When would you prefer to visit us?</p>
                    </div>
                    <div class="Whenwouldyouwanttocomeinbuttons">
                        <div class="weekcalendar">
                            <p style="margin-right: -4px;">Monday</p>
                            <div class="morningafternoonbuttons">
                                <button class="am-button">AM</button>
                                <button class="pm-button">PM</button>
                            </div>
                        </div>
                        <div class="weekcalendar" id="weekcalendartue">
                            <p style="margin-right: -4px;">Tuesday</p>
                            <div class="morningafternoonbuttons">
                                <button class="am-button-tue">AM</button>
                                <button class="pm-button-tue">PM</button>
                            </div>
                        </div>
                        <div class="weekcalendar" id="weekcalendarwed">
                            <p style="margin-right: -32px;">Wednesday</p>
                            <div class="morningafternoonbuttons">
                                <button class="am-button-wed">AM</button>
                                <button class="pm-button-wed">PM</button>
                            </div>
                        </div>
                        <div class="weekcalendar" id="weekcalendarthu">
                            <p style="margin-right: -15px;">Thursday</p>
                            <div class="morningafternoonbuttons">
                                <button class="am-button-thu">AM</button>
                                <button class="pm-button-thu">PM</button>
                            </div>
                        </div>
                        <div class="weekcalendar" id="weekcalendarfr">
                            <p style="margin-right: 8px;">Friday</p>
                            <div class="morningafternoonbuttons">
                                <button class="am-button-fr">AM</button>
                                <button class="pm-button-fr">PM</button>
                            </div>
                        </div>
                    </div>
                    <div class="previewsandforwardbutton">
                        <button id="backstep3"><   Back</button>
                        <button id="forwardstem3">Forward   ></button>
                    </div>
                </div>
            </div>
        </div>
        <div id="step4" style="display: none;">
            <div class="containterofcontent">
                <div class="topnvbar" style="margin-top: -20px;">
            
                    <button style="margin-left: 95%;">x</button>
                </div>
                <div class="scrollablecontainer">
                    <div class="welcomemessage">
                        <p>Let's grab some of your</p>
                        <p> info.</p>
                    </div>
                    <div class="container">
                        <div class="progressbar">
                            <div class="progressstep4"></div>
                            <div class="step step-1">1</div>
                            <div class="step step-2">2</div>
                            <div class="step step-3">3</div>
                            <div class="step step-4">4</div>
                        </div>
                    </div>
                
                    <div class="smallertext">
                        
                    </div>
                    <div class="moreinfoaboutyou" style="margin-left: 2px;">
                        <p style="font-size: 12px;margin-bottom: -15px;margin-left: 16px;">Name</p>
                        <div class="horizontalblocs" style="width: 200px; font-weight: 200;">
                            <input type="text" id="firstNamestep4" name="firstNamestep4" placeholder="First Name" style="width: 90px; font-weight: 200;">
                            <input type="text" id="lastNamestep4" name="lastNamestep4" placeholder="Last Name">
                        </div>
                        <div class="horizontaldate">
                            <p style="font-size: 12px;margin-bottom: 0px;">Date of birth</p>
                            <input type="date" id="birthday" name="birthday" style="width: 218px;" >
                        </div>
                        <div class="horizontaldate" style="margin-right: 0px;flex-direction: column;margin-top: -20px;">
                           <p style="font-size: 12px;margin-bottom: 0px;">Email</p>
                            <input type="email" id="email" name="email" placeholder="   jogndoe@example.com" style="width: 218px;">
                        </div>
                        <div class="horizontaldate" style="margin-right: 0px;flex-direction: column;margin-top: -20px;">
                            <p style="font-size: 12px;margin-bottom: 0px;">Phone number</p>
                             <input type="tel" id="phonenumber" name="phonenumber" placeholder="   (000)-000-0000" style="width: 218px;">
                        </div>
                        <div class="horizontaldate" style="margin-right: 0px; flex-direction: column; margin-top: -20px;">
                            <p style="font-size: 12px; margin-bottom: 0px;">Message for the Office</p>
                            <textarea id="messagetooffice" name="messagetooffice" placeholder="  "
                                      style="width: 235px; height: 100px; padding: 10px; box-sizing: border-box; resize: none;border: 2px solid #f3f3f3;border-radius: 5px;background-color: #f3f3f3;"></textarea>
                        </div>
                        
                        
                    </div>
                
                    <div class="previewsandforwardbutton" >
                        <button id="backstep4"><   Back</button>
                        <button id="forwardstep4">Submit  ></button>
                    </div>
                </div>
        </div>
        </div>
        <div id="step5" style="display: none;">
            <div class="containterofcontent">
                <div class="topnvbar">
                    <button><</button>
                    <button>x</button>
                </div>
                <div class="welcomemessage" id="custom-welcome-message">
                    <p id="custom-thank-you-message">Thank You</p>
                </div>
                
                <div class="container">
                    <div class="progressbar">
                        <div class="progressstep4"></div>
                        <div class="step step-1">1</div>
                        <div class="step step-2">2</div>
                        <div class="step step-3">3</div>
                        <div class="step step-4">4</div>
                    </div>
                </div>
                <div class="step5middlecontainer">
                    <p>Our team will reach out to you with a short phone call to confirm your appointment time.</p>
                    <p>Feel free to explore other areas of our online office.</p>
                    <p>If you have any other questions before your appointment, chat with our Assistant.</p>
                    <p>For emergencies, or other needs, please call the office directly.</p>
                </div>
        
                <div class="step5button">
        
                </div>
            </div> 
        </div>
    </div>

    <!-- Load the JavaScript file -->
    <!--<script src="{% static 'chatbot.js' %}"></script>-->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <script>
        let startY = 0;
        let currentY = 0;
        let isDragging = false;
        const refreshThreshold = 80; // Pixels needed to trigger a refresh
        const refreshIndicator = document.getElementById('refresh-indicator');

        refreshIndicator.addEventListener('touchstart', (e) => {
            if (window.scrollY === 0) { // Only activate if at the top
                startY = e.touches[0].pageY;
                isDragging = true;
            }
        });

        refreshIndicator.addEventListener('touchmove', (e) => {
            if (!isDragging) return;

            currentY = e.touches[0].pageY;
            const dragDistance = currentY - startY;

            if (dragDistance > 0) { // User is dragging down
                e.preventDefault(); // Prevent scrolling
                refreshIndicator.style.height = Math.min(dragDistance, refreshThreshold) + 'px';

                if (dragDistance > refreshThreshold) {
                    refreshIndicator.style.backgroundColor = 'transparent';
                } else {
                    refreshIndicator.style.backgroundColor = 'transparent';
                }
            }
        });

        refreshIndicator.addEventListener('touchend', () => {
            if (!isDragging) return;

            isDragging = false;
            refreshIndicator.style.height = '4px';
            refreshIndicator.style.backgroundColor = 'transparent';

            if (currentY - startY > refreshThreshold) {
                setTimeout(() => {
                    location.reload(); // Reload the page
                }, 1000);
            }
        });


    </script>

    <script>

        let isToggled = false;
        let timer;
        let buttonClicked = false; // Track if the button has been clicked

        const button = document.getElementById("testButton");
        const banner = document.getElementById("banner");
        const buttonImage = button.querySelector('img');
        const box = document.getElementById("box");

        


        // Define the image sources
        const initialImageSrc = "{% static 'leftsmile.png' %}"; // Replace with your initial image URL
        const bannerImageSrc = "{% static 'arrow.png' %}"; // Replace with your banner image URL

        // Function to get URL parameters
        // Function to get URL parameters
        
        // Function to get URL parameters

        window.onload = function() {
            var color = getUrlParameter('color');
            
                if (color) {
                    // Apply color to buttons
                    var backButton = document.getElementById('prewbtn');
                    if (backButton) {
                        backButton.style.backgroundColor = color;
                    }

                    var forwardButton = document.getElementById('nextbtn');
                    if (forwardButton) {
                        forwardButton.style.backgroundColor = color;
                    }

                    // Apply color to elements with specific classes
                    var classList = ['show', 'chat_immages', 'progress', 'progressstep2', 'progressstep3', 'progressstep4', 'active','addressbutton','bannerclass','testButton'];
                    classList.forEach(function(className) {
                        var elements = document.getElementsByClassName(className);
                        for (var i = 0; i < elements.length; i++) {
                            elements[i].style.backgroundColor = color;
                        }
                    });

                    // Apply color to elements with specific IDs
                    var idList = ['addressbutton', 'addressbutton2'];
                    idList.forEach(function(idName) {
                        var element = document.getElementById(idName);
                        if (element) {
                            element.style.backgroundColor = color;
                        }
                    });

                    // Handle dynamic classes
                    var dynamicClassList = ['bannerclass', 'patientBtn'];
                    dynamicClassList.forEach(function(className) {
                        var elements = document.getElementsByClassName(className);
                        for (var i = 0; i < elements.length; i++) {
                            var element = elements[i];
                            // Apply color if the element has the dynamic class
                            if (element.classList.contains('show') || element.classList.contains('active')) {
                                element.style.backgroundColor = color;
                                element.style.color = 'white'; // Adjust text color for better visibility
                            }
                        }
                    });



                    // Add an event listener to the button
                    button.addEventListener("click", function() {
                        // Set the flag to true when the button is clicked
                        buttonClicked = true;

                        if (isToggled) {
                            // Reset to the original border-radius and background color
                            this.style.borderTopLeftRadius = "40px";
                            this.style.borderBottomLeftRadius = "40px";
                            this.style.borderTopRightRadius = "40px";
                            this.style.borderBottomRightRadius = "0px";
                            this.style.backgroundColor = color;
                            // Reset image rotation and change image source back
                            buttonImage.style.transform = "translate(-50%, -50%) rotate(0deg)";
                            buttonImage.src = initialImageSrc;
                            box.classList.remove("showbox");
                        } else {
                            // Change to the new border-radius and background color
                            this.style.borderTopLeftRadius = "0px";
                            this.style.borderBottomLeftRadius = "40px";
                            this.style.borderTopRightRadius = "40px";
                            this.style.borderBottomRightRadius = "40px";
                            this.style.backgroundColor = color;
                            // Apply image rotation and change image source
                            buttonImage.style.transform = "translate(-50%, -50%) rotate(-90deg)";
                            buttonImage.src = initialImageSrc; // Ensure initial image when toggled
                            box.classList.add("showbox");
                        }

                        // Toggle the state
                        isToggled = !isToggled;

                        // Reset the timer each time the button is clicked
                        resetTimer();
                    });

                    // Observe DOM changes to apply styles dynamically
                    observeDomChanges(color);
                    // Apply dynamic CSS rules
                    applyDynamicStyles(color);

                }
            
        };
        function getUrlParameter(name) {
            var results = new RegExp('[?&]' + name + '=([^&#]*)').exec(window.location.href);
            return results ? decodeURIComponent(results[1].replace(/\+/g, ' ')) : null;
        }

        // Function to create a <style> element and add CSS rules
        function applyDynamicStyles(color) {
            var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = `
                .buttontest button:hover::before {
                    background-color: ${color};
                }

                .buttontest button:hover::after {
                    background-color: ${color};
                }

                .buttontest button:hover img {
                    transform: translate(-50%, -50%) rotate(0deg); /* Rotate the image on hover */
                }
                .buttontest button {
                    width: 50px;
                    height: 50px;
                    border: none;
                    border-radius: 40px 40px 0px 40px; /* Make the button fully rounded */
                    position: relative; /* Ensure the button is positioned relative to its container */
                    transition: border-radius 0.5s ease, background-color 0.5s ease; /* Add smooth transitions */
                    background-color:${color};
                    overflow: hidden; /* Ensure the image fits within the button */
                }

                .buttontest button::before {
                    content: "";
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color:${color}; /* Apply the desired color to the rectangle */
                    border-radius: 40px; /* Match the button's border radius */
                    transition: background-color 0.5s ease; /* Smooth transition for background color */
                }

                .buttontest button::after {
                    content: "";
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 50px;
                    height: 50px;
                    background-color: ${color}; /* Same color as the rectangle */
                    border-radius: 40px; /* Same radius to match button */
                    transition: background-color 0.5s ease; /* Smooth transition for background color */
                }

            `;
            document.head.appendChild(style);
        }


        // Function to observe DOM changes and apply styles
        function observeDomChanges(color) {
            var targetNode = document.body;
            var config = { attributes: true, childList: true, subtree: true };

            var callback = function(mutationsList, observer) {
                mutationsList.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && (mutation.target.classList.contains('show') || mutation.target.classList.contains('active'))) {
                        mutation.target.style.backgroundColor = color;
                        mutation.target.style.color = 'white'; // Adjust text color for better visibility
                    }
                });
            };

            var observer = new MutationObserver(callback);
            observer.observe(targetNode, config);
        }

        // Initialize on window load
        

        // Function to show the banner
        function showBanner() {
            if (!buttonClicked) { // Show banner only if button hasn't been clicked
                banner.style.display = "block";
                // Change the image when the banner is shown
                buttonImage.src = bannerImageSrc;
            }
        }

        // Function to hide the banner
        function hideBanner() {
            banner.style.display = "none";
        }

        // Function to reset the timer
        function resetTimer() {
            clearTimeout(timer); // Clear any existing timer
            hideBanner(); // Hide the banner
            // Set a new timer to show the banner after 10 seconds
            timer = setTimeout(showBanner, 10000); // 10 seconds
        }

        

        // Start the timer when the page loads
        resetTimer();

    </script>
    <script>
        let isToggled2 = false;
        let timer2;
        let buttonClicked2 = false; // Track if the button has been clicked

        const button2 = document.getElementById("testButton");
        const banner2 = document.getElementById("banner");
        const buttonImage2 = button.querySelector('img');
        const box2 = document.getElementById("box");
        const initialImageSrc2 = "{% static 'leftsmile.png' %}"; // Replace with your initial image URL
        const bannerImageSrc2 = "{% static 'arrow.png' %}"; // Replace with your banner image URL

        
        function showBanner() {
            if (!buttonClicked) { // Show banner only if button hasn't been clicked
                banner.style.display = "block";
                // Change the image when the banner is shown
                buttonImage.src = bannerImageSrc;
            }
        }

        // Function to hide the banner
        function hideBanner() {
            banner.style.display = "none";
        }

        // Function to reset the timer
        function resetTimer() {
            clearTimeout(timer); // Clear any existing timer
            hideBanner(); // Hide the banner
            // Set a new timer to show the banner after 10 seconds
            timer = setTimeout(showBanner, 10000); // 10 seconds
        }

        button.addEventListener("click", function() {
            // Set the flag to true when the button is clicked
            buttonClicked = true;

            if (isToggled2) {
                // Reset to the original border-radius and background color
                this.style.borderTopLeftRadius = "40px";
                this.style.borderBottomLeftRadius = "40px";
                this.style.borderTopRightRadius = "40px";
                this.style.borderBottomRightRadius = "0px";
                this.style.backgroundColor = "#0088cc";
                // Reset image rotation and change image source back
                buttonImage.style.transform = "translate(-50%, -50%) rotate(0deg)";
                buttonImage.src = initialImageSrc;
                box.classList.remove("showbox");
            } else {
                // Change to the new border-radius and background color
                this.style.borderTopLeftRadius = "0px";
                this.style.borderBottomLeftRadius = "40px";
                this.style.borderTopRightRadius = "40px";
                this.style.borderBottomRightRadius = "40px";
                this.style.backgroundColor = "#0088cc";
                // Apply image rotation and change image source
                buttonImage.style.transform = "translate(-50%, -50%) rotate(-90deg)";
                buttonImage.src = initialImageSrc; // Ensure initial image when toggled
                box.classList.add("showbox"); 
            }

            // Toggle the state
            isToggled2 = !isToggled2;

            // Reset the timer each time the button is clicked
            resetTimer();
        });

        // Start the timer when the page loads
        resetTimer();

        // Define the image sources
       
    </script>

    <script defer>
        document.addEventListener("DOMContentLoaded", function() {
            var menuIcon = document.getElementById("menu-icon");
            if (menuIcon) {
                menuIcon.onclick = function() {
                    console.log("the image is clicked");
                };
            }
        });
    </script>

    <script>

        function transitionToStep(currentStep, nextStep, fadeOutDuration = 0.5, fadeInDuration = 0.5) {
                        // Apply fade-out animation to the current step
                        currentStep.classList.add('fade-out');
                        currentStep.style.animationDuration = `${fadeOutDuration}s`;

                        // After the fade-out animation ends, hide the current step and show the next step
                        currentStep.addEventListener('animationend', function onAnimationEnd() {
                            currentStep.style.display = 'none';
                            currentStep.classList.remove('fade-out');
                            currentStep.removeEventListener('animationend', onAnimationEnd); // Clean up the event listener

                            // Show the next step with fade-in animation
                            nextStep.style.display = 'block';
                            nextStep.classList.add('fade-in');
                            nextStep.style.animationDuration = `${fadeInDuration}s`;

                            // Optional: Remove fade-in class after animation ends
                            nextStep.addEventListener('animationend', function onFadeInEnd() {
                                nextStep.classList.remove('fade-in');
                                nextStep.removeEventListener('animationend', onFadeInEnd); // Clean up the event listener
                            });
                        });
        }

        let firstNameInput;
        let lastNameInput;

        document.addEventListener('DOMContentLoaded', (event) => {
    // Step 1 Variables
    const buttons = document.querySelectorAll('.patientBtn');
    const firstNameInput = document.getElementById('namestep1');
    const lastNameInput = document.getElementById('lastnamestep1');
    const nextbtn = document.getElementById('nextbtn');
    const prewbtn = document.getElementById('prewbtn');
    const step1 = document.getElementById('step1');
    const mapid = document.getElementById('mapid');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    const step4 = document.getElementById('step4');
    const step5 = document.getElementById('step5');
    let selectedButton = '';

    // Function to handle button clicks
    function handleButtonClick(event) {
        // Remove 'active' class from all buttons
        buttons.forEach(button => {
            button.classList.remove('active');
        });

        // Add 'active' class to the clicked button
        event.currentTarget.classList.add('active');

        // Update the selectedButton variable
        selectedButton = event.currentTarget.id;
    }

    // Function to validate form and button selection
    function validateForm() {
        const firstName = firstNameInput.value.trim();
        const lastName = lastNameInput.value.trim();
        const isButtonSelected = document.querySelector('.patientBtn.active') !== null;

        // Check if input fields are filled and a button is selected
        if (firstName === '' || lastName === '') {
            alert('Please enter both first and last names.');
            return false;
        }
        if (!isButtonSelected) {
            alert('Please select an option.');
            return false;
        }
        return { isValid: true, firstName, lastName, selectedButton };
    }

    // Function to transition between steps
    

    // Add event listener to the 'Next' button
    let valrezfirstname;
    let valrezlastname;

    nextbtn.addEventListener('click', (event) => {
        const validationResult = validateForm();
        if (validationResult.isValid) {
            // Store the validated names in the session storage to be used later
           

            console.log('First Name:', validationResult.firstName);
            valrezfirstname=validationResult.firstName;
            console.log('Last Name:', validationResult.lastName);
            valrezlastname=validationResult.lastName;
            console.log('Selected Button ID:', validationResult.selectedButton);

            const firstNamestep4 = document.getElementById('firstNamestep4');
            const lastNamestep4 = document.getElementById('lastNamestep4');

            // Autofill Step 4 inputs with Step 1 values stored in session storage
            firstNamestep4.value = validationResult.firstName|| '';
            lastNamestep4.value =validationResult.lastName|| '';

            // Proceed to the next step if validation passes
            transitionToStep(step1, step2);
        } else {
            event.preventDefault(); // Prevent transition if validation fails
        }
    });

    // Add event listener for the 'Previous' button
    prewbtn.addEventListener('click', () => {
        transitionToStep(step1, mapid);
    });

    // Attach click event listeners to all buttons
    buttons.forEach(button => {
        button.addEventListener('click', handleButtonClick);
    });

    // Step 4 Autofill using values from Step 1
    const backstep4 = document.getElementById('backstep4');
    const forwardstep4 = document.getElementById('forwardstep4');
    

    // Step 4 Navigation
    backstep4.addEventListener('click', () => {
        transitionToStep(step4, step3);
    });


    function areAllFieldsCompleted() {
        const firstNamestep44 = document.getElementById('firstNamestep4').value.trim();
        const lastNamestep44 = document.getElementById('lastNamestep4').value.trim();
        const birthday = document.getElementById('birthday').value.trim();
        const email = document.getElementById('email').value.trim();
        const phonenumber = document.getElementById('phonenumber').value.trim();
        

        // Create an array of all the fields
        const fields = [
            { field: firstNamestep44, name: 'First Name' },
            { field: lastNamestep44, name: 'Last Name' },
            { field: birthday, name: 'Birthday' },
            { field: email, name: 'Email' },
            { field: phonenumber, name: 'Phone Number' }
        ];

        // Loop through each field to check if it's empty
        for (let i = 0; i < fields.length; i++) {
            if (fields[i].field === '') {
                alert(`Please complete the ${fields[i].name} field.`);
                return false; // Stop the function if a field is empty
            }
        }

        return true; // All fields are filled
    }

    forwardstep4.addEventListener('click', () => {
        // Check if all fields are completed
        if (areAllFieldsCompleted()) {
            const firstNamestep44 = document.getElementById('firstNamestep4').value.trim();
            const lastNamestep44 = document.getElementById('lastNamestep4').value.trim();
            const birthday = document.getElementById('birthday').value.trim();
            const email = document.getElementById('email').value.trim();
            const phonenumber = document.getElementById('phonenumber').value.trim();
            const messagetooffice = document.getElementById('messagetooffice').value.trim();

            console.log(firstNamestep44, lastNamestep44, birthday);
            console.log(email, phonenumber, messagetooffice);

            const data = {
                first_name: firstNamestep44,
                last_name: lastNamestep44,
                birthday: birthday,
                email: email,
                phone_number: phonenumber,
                message_to_office: messagetooffice,
                clicked_buttons: clickedButtonsArray,
                selections: selections
            };

            // Send data to the backend via a POST request
            fetch('', {  // Replace with your actual Django endpoint
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken') // CSRF token for security
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                    
                }
                return response.json();
            })
            .then(result => {
                console.log('Success:', result);
                transitionToStep(step4, step5); // Proceed to the next step
            })
            .catch(error => {
                console.error('Error:', error);
                transitionToStep(step4, step5); 
            });

            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
        }
    });

    //STEP2 BOX

        
        // Function to handle button clicks
        const clickedButtonsArray = [];
        const backstep2 = document.getElementById('backstep2');

        // Function to handle button clicks
        function handleButtonClickstep2(event) {
            const button = event.target;
            const buttonText = button.textContent;

            // Toggle the 'clicked' class on the clicked button
            button.classList.toggle('clicked');

            if (button.classList.contains('clicked')) {
                // If the button is clicked, add it to the array
                clickedButtonsArray.push(buttonText);
            } else {
                // If the button is unclicked, remove it from the array
                const index = clickedButtonsArray.indexOf(buttonText);
                if (index > -1) {
                    clickedButtonsArray.splice(index, 1);
                }
            }
        }

        // Attach click event listener to all buttons
        document.querySelectorAll('.typeofbtn').forEach(button => {
            button.addEventListener('click', handleButtonClickstep2);
        });

        // Function to handle the "Forward" button click
        document.getElementById('nextstep2').addEventListener('click', () => {
            // Check if at least one button is clicked
            if (clickedButtonsArray.length === 0) {
                // Display a warning message or prevent transition
                alert('Please select at least one option before proceeding.');
                return; // Prevents the transition to step 3
            }

            console.log('Buttons clicked:', clickedButtonsArray);

            // Proceed with the transition to step 3 if a button is clicked
            transitionToStep(step2, step3);
        });

        // Handle the "Back" button click
        backstep2.addEventListener('click', () => {
            transitionToStep(step2, step1);
        });



        //STEP3
        const backstep3=document.getElementById('backstep3');
        const forwardstem3=document.getElementById('forwardstem3');


        const weekCalendarDivs = document.querySelectorAll('.Whenwouldyouwanttocomeinbuttons .weekcalendar');
        const forwardButton = document.getElementById('forwardstem3');
        
        // Initialize a state object to store selections
        const selections = {};
    
        weekCalendarDivs.forEach(weekCalendarDiv => {
            const pTag = weekCalendarDiv.querySelector('p');
            const amButton = weekCalendarDiv.querySelector('.am-button') || weekCalendarDiv.querySelector('.am-button-tue') || weekCalendarDiv.querySelector('.am-button-wed') || weekCalendarDiv.querySelector('.am-button-thu') || weekCalendarDiv.querySelector('.am-button-fr');
            const pmButton = weekCalendarDiv.querySelector('.pm-button') || weekCalendarDiv.querySelector('.pm-button-tue') || weekCalendarDiv.querySelector('.pm-button-wed') || weekCalendarDiv.querySelector('.pm-button-thu') || weekCalendarDiv.querySelector('.pm-button-fr');
            
            const originalBorderColor = getComputedStyle(weekCalendarDiv).border;
            let isToggled = false; // Flag to keep track of toggle state
    
            // Track selections
            selections[pTag.textContent] = { am: false, pm: false };
    
            pTag.addEventListener('click', function() {
                if (isToggled) {
                    // Reset border and button style
                    weekCalendarDiv.style.border = originalBorderColor;
                    amButton.style.backgroundColor = '#f3f3f3';
                    amButton.style.color = '#555';
                    if (pmButton) {
                        pmButton.style.backgroundColor = '#f3f3f3'; // Reset PM button style
                        pmButton.style.color = '#555'; // Reset PM button style
                    }
                    // Update selections
                    selections[pTag.textContent] = { am: false, pm: false };
                } else {
                    // Set border and change button style
                    weekCalendarDiv.style.border = '2px solid #0088cc';
                    if (pmButton) {
                        pmButton.style.backgroundColor = '#f3f3f3'; // Default PM button color
                        pmButton.style.color = '#555'; // Default PM button color
                    }
                    // Update selections
                    selections[pTag.textContent] = { am: amButton.style.backgroundColor === '#0088cc', pm: pmButton ? pmButton.style.backgroundColor === '#0088cc' : false };
                }
                isToggled = !isToggled; // Toggle the state
            });
    
            // Handle AM button click
            if (amButton) {
                amButton.addEventListener('click', function() {
                    weekCalendarDiv.style.border = '2px solid #0088cc';
                    amButton.style.backgroundColor = '#0088cc';
                    amButton.style.color = 'white';
                    // Update selections
                    selections[pTag.textContent].am = true;
                });
            }
    
            // Handle PM button click
            if (pmButton) {
                pmButton.addEventListener('click', function() {
                    weekCalendarDiv.style.border = '2px solid #0088cc';
                    pmButton.style.backgroundColor = '#0088cc';
                    pmButton.style.color = 'white';
                    // Update selections
                    selections[pTag.textContent].pm = true;
                });
            }
        });


        backstep3.addEventListener('click', () => {
            transitionToStep(step3, step2);
        });

        forwardstem3.addEventListener('click', () => {
            transitionToStep(step3, step4);
            console.log('Selections:', selections);
        });
});






        


        //STEP4
        
        
        

    </script>

    <script>
        

        document.addEventListener('DOMContentLoaded', function() {
            function getUrlParameter(name) {
                var results = new RegExp('[?&]' + name + '=([^&#]*)').exec(window.location.href);
                return results ? decodeURIComponent(results[1].replace(/\+/g, ' ')) : null;
            }

            function transitionToStep(currentStep, nextStep, fadeOutDuration = 0.5, fadeInDuration = 0.5) {
                // Apply fade-out animation to the current step
                currentStep.classList.add('fade-out');
                currentStep.style.animationDuration = `${fadeOutDuration}s`;

                // After the fade-out animation ends, hide the current step and show the next step
                currentStep.addEventListener('animationend', function onAnimationEnd() {
                    currentStep.style.display = 'none';
                    currentStep.classList.remove('fade-out');
                    currentStep.removeEventListener('animationend', onAnimationEnd); // Clean up the event listener

                    // Show the next step with fade-in animation
                    nextStep.style.display = 'block';
                    nextStep.classList.add('fade-in');
                    nextStep.style.animationDuration = `${fadeInDuration}s`;

                    // Optional: Remove fade-in class after animation ends
                    nextStep.addEventListener('animationend', function onFadeInEnd() {
                        nextStep.classList.remove('fade-in');
                        nextStep.removeEventListener('animationend', onFadeInEnd); // Clean up the event listener
                    });
                });
            }
    // Initialize Leaflet map
            var markersData = JSON.parse('{{ markers_data|escapejs }}'); // Ensure JSON is safely parsed

            // Get the first element's coordinates
            var firstKey = Object.keys(markersData)[0]; // Get the first key
            var firstCoordinates = markersData[firstKey]; // Get the corresponding coordinates

            // Initialize Leaflet map with the first element's coordinates

            //nord=firstCoordinates.lat ;
            //est=firstCoordinates.lng;
            var nord = 31.0;
            var est = -100.0;
            var map = L.map('mapid').setView([nord, est], 2); // Set the view to the first location
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Custom icon
            var customIcon = L.icon({
                iconUrl: "{% static 'ico_thumbnail.webp' %}", // Path to your custom icon image
                iconSize: [32, 32], // Size of the icon
                iconAnchor: [16, 32], // Point of the icon which will correspond to marker's location
                popupAnchor: [0, -32] // Point from which the popup should open relative to the iconAnchor
            });
            var color = getUrlParameter('color');
            // Add markers to the map
            Object.keys(markersData).forEach(function(key) {
                var data = markersData[key];
                var popupContent = `
                    <div class="popup-content" style="display:flex;flex-direction:column;">
                        <span>${key}</span>
                        <button onclick="handleButtonClick('${key}')" style="color: ${color};">Select</button>
                    </div>
                `;
                
                L.marker([data.lat, data.lng], { icon: customIcon })
                    .addTo(map)
                    .bindPopup(popupContent);
            });

            // Handle button click event
            window.handleButtonClick = function(address) {
                console.log(address);
                transitionToStep(mapid,step1);
                
            };

        console.log('Script is running!');

        // Event listener for the image click
        var chatImg = document.getElementById('appointment_immage_button');
        console.log(chatImg);
        if (chatImg) {
            chatImg.addEventListener('click', function() {
                console.log('Image clicked!');

                var boxDiv = document.getElementById('box');
                var mapDiv = document.getElementById('mapid');
                var contentChatbotDiv = document.querySelector('.contentchatbot');

                if (boxDiv) {
                    boxDiv.classList.add('hidden');  // Add 'hidden' class to hide the box div
                    console.log('Box div hidden!');
                } else {
                    console.error('Element with ID box not found.');
                }

                if (contentChatbotDiv) {
                    contentChatbotDiv.classList.add('hidden'); // Add 'hidden' class to hide the contentchatbot div
                    console.log('Contentchatbot div hidden!');
                } else {
                    console.error('Element with class contentchatbot not found.');
                }

                if (mapDiv) {
                    mapDiv.style.display = 'block';  // Show the map div
                    console.log('Map div displayed!');
                } else {
                    console.error('Element with ID mapid not found.');
                }
            });
        } else {
            console.error('Element with ID appointment_immage_button not found.');
        }
    });

    </script>
</body>
</html>
